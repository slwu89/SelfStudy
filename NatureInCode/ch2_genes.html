<!DOCTYPE html>
<html>

<head>
  <title>Nature, in Code</title>
  <script type="text/javascript">
    console.log("My first line of JavaScript");
    // this is a comment - it won't be executed

    //DOING BY HAND
    //genotype frequencies
    var a1a1 = 0.15;
    var a2a2 = 0.35;
    var a1a2 = 1 - (a1a1 + a2a2);

    //allele frequencies
    var p = a1a1 + (a1a2 / 2);
    var q = 1 - p;

    //write evaluation to output
    //console.log("generation 0:\t" + a1a1 + "\t" + a1a2 + "\t" + a2a2);

    //alternate writing to output
    console.log("generation 0:", a1a1, a1a2, a2a2);

    //calculate gen 1 genotype freq with allele freq
    a1a1 = p * p;
    a1a2 = 2 * p * q;
    a2a2 = q * q;
    console.log("generation 1:", a1a1, a1a2, a2a2);

    //calculate gen 2 genotype freq with allele freq
    a1a1 = p * p;
    a1a2 = 2 * p * q;
    a2a2 = q * q;
    console.log("generation 2:", a1a1, a1a2, a2a2);

    //calculate gen 3 genotype freq with allele freq
    a1a1 = p * p;
    a1a2 = 2 * p * q;
    a2a2 = q * q;
    console.log("generation 3:", a1a1, a1a2, a2a2);

    //calculate gen 4 genotype freq with allele freq
    a1a1 = p * p;
    a1a2 = 2 * p * q;
    a2a2 = q * q;
    console.log("generation 4:", a1a1, a1a2, a2a2);

    //DOING BY FUNCTIONS
    //function to advance genetation genotype freq
    function create_next_generation() {
      a1a1 = p * p;
      a1a2 = 2 * p * q;
      a2a2 = q * q;
    }

    console.log("now using a function to do above")
    //genotype frequencies
    var a1a1 = 0.15;
    var a2a2 = 0.35;
    var a1a2 = 1 - (a1a1 + a2a2);

    //allele frequencies
    var p = a1a1 + (a1a2 / 2);
    var q = 1 - p;

    console.log("generation 0:", a1a1, a1a2, a2a2);

    create_next_generation();
    console.log("generation 1:", a1a1, a1a2, a2a2);

    create_next_generation();
    console.log("generation 2:", a1a1, a1a2, a2a2);

    create_next_generation();
    console.log("generation 3:", a1a1, a1a2, a2a2);

    create_next_generation();
    console.log("generation 4:", a1a1, a1a2, a2a2);

    create_next_generation();
    console.log("generation 5:", a1a1, a1a2, a2a2);

    //FOR LOOPS
    //do above with for loop
    console.log("using for loops")
    //genotype frequencies
    var a1a1 = 0.15;
    var a2a2 = 0.35;
    var a1a2 = 1 - (a1a1 + a2a2);

    //allele frequencies
    var p = a1a1 + (a1a2 / 2);
    var q = 1 - p;

    console.log("generation 0:", a1a1 , a1a2, a2a2);

    for(var i = 0; i < 5; i=i+1) {
      create_next_generation();
      console.log("generation "+(i+1)+":", a1a1, a1a2, a2a2);
    }

    //ALLOW ALLELE FREQUENCY TO VARY
    //calculate allele freq from genotype freq
    function calculate_allele_frequences() {
      p = a1a1 + (a1a2 / 2);
      q = 1 - p;
    }

    //modify our previous function
    function create_next_generation() {
      calculate_allele_frequences();
      a1a1 = p * p;
      a1a2 = 2 * p * q;
      a2a2 = q * q;
    }

    //function to round to 2 decimals
    function round_number(value) {
      return Math.round(value * 100) / 100;
    }

    //modify it to round to arbitrary number of decimals
    function round_number(value, decimals) {
      var shifter = Math.pow(10,decimals);
      return Math.round(value * shifter) / shifter;
    }

    var a1a1 = 0.15;
    var a2a2 = 0.35;
    var a1a2 = 1 - (a1a1 + a2a2);

    var p = a1a1 + (a1a2 / 2);
    var q = 1 - p;

    console.log("generation 0:", a1a1, a1a2, a2a2);

    for(var i = 0; i < 5; i=i+1) {
      create_next_generation();
      console.log("generation "+(i+1)+":", round_number(a1a1,2), round_number(a1a2,2), round_number(a2a2,2));
    }
  </script>
</head>

<body>
  Hello, nature.
  <br>Nice to be with you.
</body>

</html>
